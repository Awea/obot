#!/usr/bin/env ruby

require 'thor'
require 'sequel'
require 'watir-webdriver'

require_relative '../lib/obot'

DB  = Sequel.sqlite
NAV = Watir::Browser.new :firefox, profile: 'default'

NAV.add_checker do |page|
  page.alert.close if page.alert.exists?
end

class ObotCLI < Thor

  option :config_file
  desc 'default_loop', 'run the default_loop'
  def default_loop
    obot = Obot.new(
      options[:config_file] ? options[:config_file] : 'config.yml'
    )
    Loop.new(obot).run_default
  end
end

ObotCLI.start(ARGV)

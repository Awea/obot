#!/usr/bin/env ruby

require 'thor'
require 'sequel'

require_relative '../lib/obot'
require_relative '../lib/obot/loop'

DB = Sequel.sqlite

class ObotCLI < Thor

  option :config_file
  desc 'default_loop', 'run the default_loop'
  def default_loop
    obot = Obot.new(
      options[:config_file] ? options[:config_file] : 'config.yml'
    )
    bot_loop(obot).run_default
  end

  desc 'test', 'for test only'
  def test
    obot = Obot.new(
      options[:config_file] ? options[:config_file] : 'config.yml',
      false
    )

    puts obot.first_unatacked_planet('[3:189:7]').inspect
  end

  private

  def bot_loop(obot)
    Loop.new(obot)
  end
end

ObotCLI.start(ARGV)
